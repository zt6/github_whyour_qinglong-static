(self.webpackChunk=self.webpackChunk||[]).push([[7953],{81043:function(p,C,e){"use strict";e.d(C,{Z:function(){return c}});var o=e(79105),l=e(63313),f={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M686.7 638.6L544.1 535.5V288c0-4.4-3.6-8-8-8H488c-4.4 0-8 3.6-8 8v275.4c0 2.6 1.2 5 3.3 6.5l165.4 120.6c3.6 2.6 8.6 1.8 11.2-1.7l28.6-39c2.6-3.7 1.8-8.7-1.8-11.2z"}}]},name:"clock-circle",theme:"outlined"},m=f,b=e(17980),r=function(h,D){return l.createElement(b.Z,(0,o.Z)((0,o.Z)({},h),{},{ref:D,icon:m}))};r.displayName="ClockCircleOutlined";var c=l.forwardRef(r)},39449:function(p,C,e){"use strict";e.d(C,{Z:function(){return c}});var o=e(79105),l=e(63313),f={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"},m=f,b=e(17980),r=function(h,D){return l.createElement(b.Z,(0,o.Z)((0,o.Z)({},h),{},{ref:D,icon:m}))};r.displayName="DeleteOutlined";var c=l.forwardRef(r)},67020:function(p,C,e){"use strict";e.d(C,{Z:function(){return c}});var o=e(79105),l=e(63313),f={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM504 618H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM312 490v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8z"}}]},name:"file-text",theme:"outlined"},m=f,b=e(17980),r=function(h,D){return l.createElement(b.Z,(0,o.Z)((0,o.Z)({},h),{},{ref:D,icon:m}))};r.displayName="FileTextOutlined";var c=l.forwardRef(r)},7651:function(p,C,e){"use strict";e.d(C,{Z:function(){return c}});var o=e(79105),l=e(63313),f={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 1024c-69.1 0-136.2-13.5-199.3-40.2C251.7 958 197 921 150 874c-47-47-84-101.7-109.8-162.7C13.5 648.2 0 581.1 0 512c0-19.9 16.1-36 36-36s36 16.1 36 36c0 59.4 11.6 117 34.6 171.3 22.2 52.4 53.9 99.5 94.3 139.9 40.4 40.4 87.5 72.2 139.9 94.3C395 940.4 452.6 952 512 952c59.4 0 117-11.6 171.3-34.6 52.4-22.2 99.5-53.9 139.9-94.3 40.4-40.4 72.2-87.5 94.3-139.9C940.4 629 952 571.4 952 512c0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.2C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3s-13.5 136.2-40.2 199.3C958 772.3 921 827 874 874c-47 47-101.8 83.9-162.7 109.7-63.1 26.8-130.2 40.3-199.3 40.3z"}}]},name:"loading-3-quarters",theme:"outlined"},m=f,b=e(17980),r=function(h,D){return l.createElement(b.Z,(0,o.Z)((0,o.Z)({},h),{},{ref:D,icon:m}))};r.displayName="Loading3QuartersOutlined";var c=l.forwardRef(r)},97260:function(p,C,e){"use strict";e.d(C,{Z:function(){return c}});var o=e(79105),l=e(63313),f={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"},m=f,b=e(17980),r=function(h,D){return l.createElement(b.Z,(0,o.Z)((0,o.Z)({},h),{},{ref:D,icon:m}))};r.displayName="PauseCircleOutlined";var c=l.forwardRef(r)},9594:function(p,C,e){"use strict";e.d(C,{Z:function(){return c}});var o=e(79105),l=e(63313),f={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]},name:"play-circle",theme:"outlined"},m=f,b=e(17980),r=function(h,D){return l.createElement(b.Z,(0,o.Z)((0,o.Z)({},h),{},{ref:D,icon:m}))};r.displayName="PlayCircleOutlined";var c=l.forwardRef(r)},2679:function(p,C,e){"use strict";e.d(C,{Z:function(){return c}});var o=e(79105),l=e(63313),f={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z"}}]},name:"stop",theme:"outlined"},m=f,b=e(17980),r=function(h,D){return l.createElement(b.Z,(0,o.Z)((0,o.Z)({},h),{},{ref:D,icon:m}))};r.displayName="StopOutlined";var c=l.forwardRef(r)},32050:function(p,C,e){"use strict";e.r(C),e.d(C,{IntervalSchedule:function(){return G},SubscriptionStatus:function(){return B},SubscriptionType:function(){return le},default:function(){return Y}});var o=e(94434),l=e.n(o),f=e(46686),m=e.n(f),b=e(30279),r=e.n(b),c=e(63313),v=e(6946),h=e(2991),D=e(34541),he=e(26591),d=e(74318),re=e(97325),I=e(80743),ne=e(6834),J=e(54659),z=e(74309),de=e(46669),ie=e(81043),me=e(7651),S=e(31004),t=e(9594),P=e(97260),i=e(67020),y=e(26099),ae=e(96320),q=e(2679),L=e(39449),Z=e(94764),M=e(9408),V=e(35563),H=e(45362),ee=e(2792),j=e(79610),X=e(55261),ue=e(11510),u=e(11527),w=v.Z.Text,Ee=v.Z.Paragraph,Q=h.Z.Search,B;(function(g){g[g.running=0]="running",g[g.idle=1]="idle",g[g.disabled=2]="disabled",g[g.queued=3]="queued"})(B||(B={}));var G;(function(g){g.days="\u5929",g.hours="\u65F6",g.minutes="\u5206",g.seconds="\u79D2"})(G||(G={}));var le;(function(g){g["private-repo"]="\u79C1\u6709\u4ED3\u5E93",g["public-repo"]="\u516C\u5F00\u4ED3\u5E93",g.file="\u5355\u6587\u4EF6"})(le||(le={}));var pe=function(){var Fe=(0,X.bx)(),Oe=Fe.headerStyle,De=Fe.isPhone,oe=Fe.socketMessage,je=[{title:"\u540D\u79F0",dataIndex:"name",key:"name",width:150,align:"center",sorter:{compare:function(n,a){return n.name.localeCompare(a.name)},multiple:2}},{title:"\u94FE\u63A5",dataIndex:"url",key:"url",align:"center",sorter:{compare:function(n,a){return n.name.localeCompare(a.name)},multiple:2},render:function(n,a){return(0,u.jsx)(Ee,{style:{wordBreak:"break-all",marginBottom:0,textAlign:"left"},ellipsis:{tooltip:n,rows:2},children:n})}},{title:"\u7C7B\u578B",dataIndex:"type",key:"type",width:130,align:"center",render:function(n,a){return le[a.type]}},{title:"\u5206\u652F",dataIndex:"branch",key:"branch",width:130,align:"center",render:function(n,a){return a.branch||"-"}},{title:"\u5B9A\u65F6\u89C4\u5219",width:180,align:"center",render:function(n,a){if(a.schedule_type==="interval"){var x=a.interval_schedule,A=x.type,T=x.value;return"\u6BCF".concat(T).concat(G[A])}return a.schedule}},{title:"\u72B6\u6001",key:"status",dataIndex:"status",align:"center",width:110,filters:[{text:"\u8FD0\u884C\u4E2D",value:0},{text:"\u7A7A\u95F2\u4E2D",value:1},{text:"\u5DF2\u7981\u7528",value:2}],onFilter:function(n,a){return a.is_disabled&&a.status!==0?n===2:a.status===n},render:function(n,a){return(0,u.jsxs)(u.Fragment,{children:[(!a.is_disabled||a.status!==B.idle)&&(0,u.jsxs)(u.Fragment,{children:[a.status===B.idle&&(0,u.jsx)(D.Z,{icon:(0,u.jsx)(ie.Z,{}),color:"default",children:"\u7A7A\u95F2\u4E2D"}),a.status===B.running&&(0,u.jsx)(D.Z,{icon:(0,u.jsx)(me.Z,{spin:!0}),color:"processing",children:"\u8FD0\u884C\u4E2D"})]}),a.is_disabled===1&&a.status===B.idle&&(0,u.jsx)(D.Z,{icon:(0,u.jsx)(S.Z,{}),color:"error",children:"\u5DF2\u7981\u7528"})]})}},{title:"\u64CD\u4F5C",key:"action",align:"center",width:130,render:function(n,a,x){var A=!De;return(0,u.jsxs)(he.Z,{size:"middle",children:[a.status===B.idle&&(0,u.jsx)(d.Z,{title:A?"\u8FD0\u884C":"",children:(0,u.jsx)("a",{onClick:function(te){te.stopPropagation(),et(a,x)},children:(0,u.jsx)(t.Z,{})})}),a.status!==B.idle&&(0,u.jsx)(d.Z,{title:A?"\u505C\u6B62":"",children:(0,u.jsx)("a",{onClick:function(te){te.stopPropagation(),tt(a,x)},children:(0,u.jsx)(P.Z,{})})}),(0,u.jsx)(d.Z,{title:A?"\u65E5\u5FD7":"",children:(0,u.jsx)("a",{onClick:function(te){te.stopPropagation(),qe(r()(r()({},a),{},{timestamp:Date.now()}))},children:(0,u.jsx)(i.Z,{})})}),(0,u.jsx)(it,{record:a,index:x},"more")]})}}],Se=(0,c.useState)([]),Pe=m()(Se,2),k=Pe[0],$=Pe[1],Ce=(0,c.useState)(!0),ye=m()(Ce,2),Ae=ye[0],Ze=ye[1],Me=(0,c.useState)(!1),Te=m()(Me,2),_=Te[0],s=Te[1],O=(0,c.useState)(),E=m()(O,2),U=E[0],K=E[1],ve=(0,c.useState)(""),se=m()(ve,2),be=se[0],R=se[1],ge=(0,c.useState)(1),xe=m()(ge,2),Be=xe[0],Ie=xe[1],Re=(0,c.useState)(20),fe=m()(Re,2),Ve=fe[0],Le=fe[1],ke=(0,c.useState)(),We=m()(ke,2),He=We[0],we=We[1],Qe=(0,c.useState)(""),ze=m()(Qe,2),Ge=ze[0],Ye=ze[1],Je=(0,c.useState)(!1),Ue=m()(Je,2),Xe=Ue[0],Ke=Ue[1],$e=(0,c.useState)(),Ne=m()($e,2),_e=Ne[0],qe=Ne[1],et=function(n,a){re.Z.confirm({title:"\u786E\u8BA4\u8FD0\u884C",content:(0,u.jsxs)(u.Fragment,{children:["\u786E\u8BA4\u8FD0\u884C\u5B9A\u65F6\u4EFB\u52A1"," ",(0,u.jsx)(w,{style:{wordBreak:"break-all"},type:"warning",children:n.name})," ","\u5417"]}),onOk:function(){H.W.put("".concat(M.Z.apiPrefix,"subscriptions/run"),{data:[n.id]}).then(function(A){var T=A.code,te=A.data;if(T===200){var W=l()(k),N=W.findIndex(function(ce){return ce.id===n.id});N!==-1&&(W.splice(N,1,r()(r()({},n),{},{status:B.running})),$(W))}})},onCancel:function(){console.log("Cancel")}})},tt=function(n,a){re.Z.confirm({title:"\u786E\u8BA4\u505C\u6B62",content:(0,u.jsxs)(u.Fragment,{children:["\u786E\u8BA4\u505C\u6B62\u5B9A\u65F6\u4EFB\u52A1"," ",(0,u.jsx)(w,{style:{wordBreak:"break-all"},type:"warning",children:n.name})," ","\u5417"]}),onOk:function(){H.W.put("".concat(M.Z.apiPrefix,"subscriptions/stop"),{data:[n.id]}).then(function(A){var T=A.code,te=A.data;if(T===200){var W=l()(k),N=W.findIndex(function(ce){return ce.id===n.id});N!==-1&&(W.splice(N,1,r()(r()({},n),{},{pid:null,status:B.idle})),$(W))}})},onCancel:function(){console.log("Cancel")}})},nt=function(){Ze(!0),H.W.get("".concat(M.Z.apiPrefix,"subscriptions?searchValue=").concat(be)).then(function(n){var a=n.code,x=n.data;a===200&&($(x),Ie(1))}).finally(function(){return Ze(!1)})},at=function(){K(null),s(!0)},ut=function(n,a){K(n),s(!0)},lt=function(n,a){re.Z.confirm({title:"\u786E\u8BA4\u5220\u9664",content:(0,u.jsxs)(u.Fragment,{children:["\u786E\u8BA4\u5220\u9664\u5B9A\u65F6\u8BA2\u9605"," ",(0,u.jsx)(w,{style:{wordBreak:"break-all"},type:"warning",children:n.name})," ","\u5417"]}),onOk:function(){H.W.delete("".concat(M.Z.apiPrefix,"subscriptions"),{data:[n.id]}).then(function(A){var T=A.code,te=A.data;if(T===200){I.ZP.success("\u5220\u9664\u6210\u529F");var W=l()(k),N=W.findIndex(function(ce){return ce.id===n.id});N!==-1&&(W.splice(N,1),$(W))}})},onCancel:function(){console.log("Cancel")}})},rt=function(n,a){re.Z.confirm({title:"\u786E\u8BA4".concat(n.is_disabled===1?"\u542F\u7528":"\u7981\u7528"),content:(0,u.jsxs)(u.Fragment,{children:["\u786E\u8BA4",n.is_disabled===1?"\u542F\u7528":"\u7981\u7528","\u5B9A\u65F6\u8BA2\u9605"," ",(0,u.jsx)(w,{style:{wordBreak:"break-all"},type:"warning",children:n.name})," ","\u5417"]}),onOk:function(){H.W.put("".concat(M.Z.apiPrefix,"subscriptions/").concat(n.is_disabled===1?"enable":"disable"),{data:[n.id]}).then(function(A){var T=A.code,te=A.data;if(T===200){var W=n.is_disabled===1?0:1,N=l()(k),ce=N.findIndex(function(ht){return ht.id===n.id});ce!==-1&&(N.splice(ce,1,r()(r()({},n),{},{is_disabled:W})),$(N))}})},onCancel:function(){console.log("Cancel")}})},it=function(n){var a=n.record,x=n.index;return(0,u.jsx)(ne.Z,{arrow:{pointAtCenter:!0},placement:"bottomRight",trigger:["click"],overlay:(0,u.jsx)(J.Z,{items:[{label:"\u7F16\u8F91",key:"edit",icon:(0,u.jsx)(y.Z,{})},{label:a.is_disabled===1?"\u542F\u7528":"\u7981\u7528",key:"enableOrDisable",icon:a.is_disabled===1?(0,u.jsx)(ae.Z,{}):(0,u.jsx)(q.Z,{})},{label:"\u5220\u9664",key:"delete",icon:(0,u.jsx)(L.Z,{})}],onClick:function(T){var te=T.key,W=T.domEvent;W.stopPropagation(),ot(te,a,x)}}),children:(0,u.jsx)("a",{onClick:function(T){return T.stopPropagation()},children:(0,u.jsx)(Z.Z,{})})})},ot=function(n,a,x){switch(n){case"edit":ut(a,x);break;case"enableOrDisable":rt(a,x);break;case"delete":lt(a,x);break;default:break}},st=function(n){s(!1),n&&dt(n)},ct=function(n){R(n.trim())},dt=function(n){var a=k.findIndex(function(A){return A.id===n.id}),x=l()(k);a===-1?x.unshift(n):x.splice(a,1,r()({},n)),$(x)},vt=function(n,a){Ie(n),Le(a),localStorage.setItem("pageSize",a+"")},ft=function(n,a){return n.isPinned?"pinned-subscription subscription":"subscription"};return(0,c.useEffect)(function(){if(!!oe){var F=oe.type,n=oe.message,a=oe.references;if(F==="runSubscriptionEnd"&&a.length>0){for(var x=l()(k),A=function(W){var N=k.findIndex(function(ce){return ce.id===a[W]});N!==-1&&x.splice(N,1,r()(r()({},k[N]),{},{status:B.idle}))},T=0;T<a.length;T++)A(T);$(x)}}},[oe]),(0,c.useEffect)(function(){_e&&(localStorage.setItem("logSubscription",_e.id),Ke(!0))},[_e]),(0,c.useEffect)(function(){nt()},[be]),(0,c.useEffect)(function(){Le(parseInt(localStorage.getItem("pageSize")||"20")),setTimeout(function(){we((0,j.W9)())})},[]),(0,u.jsxs)(V.ZP,{className:"ql-container-wrapper subscriptiontab-wrapper",title:"\u8BA2\u9605\u7BA1\u7406",extra:[(0,u.jsx)(Q,{placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0\u6216\u8005\u5173\u952E\u8BCD",style:{width:"auto"},enterButton:!0,allowClear:!0,loading:Ae,value:Ge,onChange:function(n){return Ye(n.target.value)},onSearch:ct}),(0,u.jsx)(z.Z,{type:"primary",onClick:function(){return at()},children:"\u65B0\u5EFA\u8BA2\u9605"},"2")],header:{style:Oe},children:[(0,u.jsx)(de.Z,{columns:je,pagination:{current:Be,onChange:vt,pageSize:Ve,showSizeChanger:!0,simple:De,defaultPageSize:20,showTotal:function(n,a){return"\u7B2C ".concat(a[0],"-").concat(a[1]," \u6761/\u603B\u5171 ").concat(n," \u6761")},pageSizeOptions:[20,100,500,1e3]},dataSource:k,rowKey:"id",size:"middle",scroll:{x:1e3,y:He},loading:Ae,rowClassName:ft}),(0,u.jsx)(ee.default,{visible:_,handleCancel:st,subscription:U}),(0,u.jsx)(ue.default,{visible:Xe,handleCancel:function(){Ke(!1)},subscription:_e})]})},Y=pe},11510:function(p,C,e){"use strict";e.r(C);var o=e(46686),l=e.n(o),f=e(63313),m=e.n(f),b=e(97325),r=e(74309),c=e(45362),v=e(9408),h=e(7651),D=e(96320),he=e(37397),d=e(11527),re=function(ne){var J=ne.subscription,z=ne.handleCancel,de=ne.visible,ie=ne.data,me=ne.logUrl,S=(0,f.useState)("\u542F\u52A8\u4E2D..."),t=l()(S,2),P=t[0],i=t[1],y=(0,f.useState)(!0),ae=l()(y,2),q=ae[0],L=ae[1],Z=(0,f.useState)(!0),M=l()(Z,2),V=M[0],H=M[1],ee=(0,f.useState)(!1),j=l()(ee,2),X=j[0],ue=j[1],u=function Q(B){B&&L(!0),c.W.get(me||"".concat(v.Z.apiPrefix,"subscriptions/").concat(J.id,"/log")).then(function(G){var le=G.code,pe=G.data;if(le===200&&localStorage.getItem("logSubscription")===String(J.id)){var Y=pe;i(Y||"\u6682\u65E0\u65E5\u5FD7"),H(Y&&!Y.includes("\u6267\u884C\u7ED3\u675F")),Y&&!Y.includes("\u6267\u884C\u7ED3\u675F")&&setTimeout(function(){Q()},2e3)}}).finally(function(){B&&L(!1)})},w=function(){localStorage.removeItem("logSubscription"),z()},Ee=function(){return(0,d.jsxs)(d.Fragment,{children:[(V||q)&&(0,d.jsx)(h.Z,{spin:!0}),!V&&!q&&(0,d.jsx)(D.Z,{}),(0,d.jsx)("span",{style:{marginLeft:5},children:J&&J.name})]})};return(0,f.useEffect)(function(){J&&J.id&&de&&u(!0)},[J,de]),(0,f.useEffect)(function(){ie&&i(ie)},[ie]),(0,f.useEffect)(function(){ue(document.body.clientWidth<768)},[]),(0,d.jsx)(b.Z,{title:Ee(),open:de,centered:!0,className:"log-modal",bodyStyle:{minHeight:"300px"},forceRender:!0,onOk:function(){return w()},onCancel:function(){return w()},footer:[(0,d.jsx)(r.Z,{type:"primary",onClick:function(){return w()},children:"\u77E5\u9053\u4E86"})],children:q?(0,d.jsx)(he.Z,{}):(0,d.jsx)("pre",{style:X?{fontFamily:"Source Code Pro",width:375,zoom:.83}:{},children:P})})};C.default=re},2792:function(p,C,e){"use strict";e.r(C);var o=e(35290),l=e.n(o),f=e(30279),m=e.n(f),b=e(411),r=e.n(b),c=e(46686),v=e.n(c),h=e(63313),D=e.n(h),he=e(77073),d=e(78455),re=e(80743),I=e(2991),ne=e(69436),J=e(97325),z=e(39958),de=e(45362),ie=e(9408),me=e(38041),S=e.n(me),t=e(11527),P=he.Z.Option,i=/[^\/\:]+\/[^\/]+(?=\.git)/,y=/[^\/\:]+\/[^\/]+$/,ae=function(L){var Z=L.subscription,M=L.handleCancel,V=L.visible,H=d.Z.useForm(),ee=v()(H,1),j=ee[0],X=(0,h.useState)(!1),ue=v()(X,2),u=ue[0],w=ue[1],Ee=(0,h.useState)("public-repo"),Q=v()(Ee,2),B=Q[0],G=Q[1],le=(0,h.useState)("crontab"),pe=v()(le,2),Y=pe[0],g=pe[1],Fe=(0,h.useState)("ssh-key"),Oe=v()(Fe,2),De=Oe[0],oe=Oe[1],je=function(){var _=r()(l()().mark(function s(O){var E,U,K,ve,se;return l()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return w(!0),E=Z?"put":"post",U=m()({},O),Z&&(U.id=Z.id),R.prev=4,R.next=7,de.W[E]("".concat(ie.Z.apiPrefix,"subscriptions"),{data:U});case 7:K=R.sent,ve=K.code,se=K.data,ve===200&&(re.ZP.success(Z?"\u66F4\u65B0\u8BA2\u9605\u6210\u529F":"\u65B0\u5EFA\u8BA2\u9605\u6210\u529F"),M(se)),w(!1),R.next=17;break;case 14:R.prev=14,R.t0=R.catch(4),w(!1);case 17:case"end":return R.stop()}},s,null,[[4,14]])}));return function(O){return _.apply(this,arguments)}}(),Se=function(s){G(s.target.value);var O=j.getFieldValue("url"),E=j.getFieldValue("branch");j.setFieldsValue({alias:ye(O,E,s.target.value)}),O&&j.validateFields(["url"])},Pe=function(s){g(s.target.value),j.setFieldsValue({schedule:""})},k=function(s){oe(s.target.value)},$=function(s){var O=j.getFieldValue("branch");j.setFieldsValue({alias:ye(s.target.value,O)})},Ce=function(s){var O=j.getFieldValue("url");j.setFieldsValue({alias:ye(O,s.target.value)})},ye=function(s,O){var E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:B,U="",K=E==="file"?y:i;return K.test(s)&&(U=s.match(K)[0].replaceAll("/","_").replaceAll(".","_")),O&&(U=U+"_"+O),U},Ae=function(s){var O=s.value,E=s.onChange,U=(0,h.useState)("days"),K=v()(U,2),ve=K[0],se=K[1],be=(0,h.useState)(),R=v()(be,2),ge=R[0],xe=R[1],Be=function(fe){se(fe),ge&&ge>0&&(E==null||E({type:fe,value:ge}))},Ie=function(fe){xe(fe),fe?E==null||E({type:ve,value:fe}):E==null||E(null)};return(0,h.useEffect)(function(){O&&(se(O.type),xe(O.value))},[O]),(0,t.jsxs)(I.Z.Group,{compact:!0,children:[(0,t.jsx)(ne.Z,{addonBefore:"\u6BCF",precision:0,min:1,value:ge,style:{width:"calc(100% - 58px)"},onChange:Ie}),(0,t.jsxs)(he.Z,{value:ve,onChange:Be,children:[(0,t.jsx)(P,{value:"days",children:"\u5929"}),(0,t.jsx)(P,{value:"hours",children:"\u65F6"}),(0,t.jsx)(P,{value:"minutes",children:"\u5206"}),(0,t.jsx)(P,{value:"seconds",children:"\u79D2"})]})]})},Ze=function(s){var O=s.value,E=s.onChange,U=s.type;return U==="ssh-key"?(0,t.jsx)(d.Z.Item,{name:["pull_option","private_key"],label:"\u79C1\u94A5",rules:[{required:!0}],children:(0,t.jsx)(I.Z.TextArea,{rows:4,autoSize:{minRows:1,maxRows:6},placeholder:"\u8BF7\u8F93\u5165\u79C1\u94A5"})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Z.Item,{name:["pull_option","username"],label:"\u7528\u6237\u540D",rules:[{required:!0}],children:(0,t.jsx)(I.Z,{placeholder:"\u8BF7\u8F93\u5165\u8BA4\u8BC1\u7528\u6237\u540D"})}),(0,t.jsx)(d.Z.Item,{name:["pull_option","password"],tooltip:"Github\u5DF2\u4E0D\u652F\u6301\u5BC6\u7801\u8BA4\u8BC1\uFF0C\u8BF7\u4F7F\u7528Token\u65B9\u5F0F",label:"\u5BC6\u7801/Token",rules:[{required:!0}],children:(0,t.jsx)(I.Z,{placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801\u6216\u8005Token"})})]})},Me=(0,h.useCallback)(function(_){var s=_.clipboardData.getData("text");if(s.startsWith("ql ")){var O=s.split(" ").map(function(Be){return Be.trim().replace(/\"/g,"").replace(/\'/,"")}),E=v()(O,8),U=E[1],K=E[2],ve=E[3],se=E[4],be=E[5],R=E[6],ge=E[7],xe=U==="raw"?"file":K.startsWith("http")?"public-repo":"private-repo";j.setFieldsValue({type:xe,url:K,whitelist:ve,blacklist:se,dependences:be,branch:R,extensions:ge,alias:ye(K,R)}),G(xe)}},[]),Te=(0,h.useCallback)(function(_){var s=_.clipboardData.getData("text");s.startsWith("ql ")&&_.preventDefault()},[]);return(0,h.useEffect)(function(){V?window.addEventListener("paste",Me):window.removeEventListener("paste",Me)},[V]),(0,h.useEffect)(function(){j.setFieldsValue(Z||{}),G(Z&&Z.type||"public-repo"),g(Z&&Z.schedule_type||"crontab"),oe(Z&&Z.pull_type||"ssh-key"),Z||j.resetFields()},[Z,V]),(0,t.jsx)(J.Z,{title:Z?"\u7F16\u8F91\u8BA2\u9605":"\u65B0\u5EFA\u8BA2\u9605",open:V,forceRender:!0,centered:!0,maskClosable:!1,onOk:function(){j.validateFields().then(function(s){je(s)}).catch(function(s){console.log("Validate Failed:",s)})},onCancel:function(){return M()},confirmLoading:u,children:(0,t.jsxs)(d.Z,{form:j,name:"form_in_modal",layout:"vertical",children:[(0,t.jsx)(d.Z.Item,{name:"name",label:"\u540D\u79F0",children:(0,t.jsx)(I.Z,{placeholder:"\u652F\u6301\u62F7\u8D1Dql repo/raw\u547D\u4EE4\uFF0C\u7C98\u8D34\u5BFC\u5165",onPaste:Te})}),(0,t.jsx)(d.Z.Item,{name:"type",label:"\u7C7B\u578B",rules:[{required:!0}],initialValue:"public-repo",children:(0,t.jsxs)(z.ZP.Group,{onChange:Se,children:[(0,t.jsx)(z.ZP,{value:"public-repo",children:"\u516C\u5F00\u4ED3\u5E93"}),(0,t.jsx)(z.ZP,{value:"private-repo",children:"\u79C1\u6709\u4ED3\u5E93"}),(0,t.jsx)(z.ZP,{value:"file",children:"\u5355\u6587\u4EF6"})]})}),(0,t.jsx)(d.Z.Item,{name:"url",label:"\u94FE\u63A5",rules:[{required:!0},{pattern:B==="file"?y:i}],children:(0,t.jsx)(I.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u8BA2\u9605\u94FE\u63A5",onPaste:$,onChange:$})}),B!=="file"&&(0,t.jsx)(d.Z.Item,{name:"branch",label:"\u5206\u652F",children:(0,t.jsx)(I.Z,{placeholder:"\u8BF7\u8F93\u5165\u5206\u652F",onPaste:Ce,onChange:Ce})}),(0,t.jsx)(d.Z.Item,{name:"alias",label:"\u552F\u4E00\u503C",rules:[{required:!0,message:""}],tooltip:"\u552F\u4E00\u503C\u7528\u4E8E\u65E5\u5FD7\u76EE\u5F55\u548C\u79C1\u94A5\u522B\u540D",children:(0,t.jsx)(I.Z,{placeholder:"\u81EA\u52A8\u751F\u6210",disabled:!0})}),B==="private-repo"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Z.Item,{name:"pull_type",label:"\u62C9\u53D6\u65B9\u5F0F",initialValue:"ssh-key",rules:[{required:!0}],children:(0,t.jsxs)(z.ZP.Group,{onChange:k,children:[(0,t.jsx)(z.ZP,{value:"ssh-key",children:"\u79C1\u94A5"}),(0,t.jsx)(z.ZP,{value:"user-pwd",children:"\u7528\u6237\u540D\u5BC6\u7801/Token"})]})}),(0,t.jsx)(Ze,{type:De})]}),(0,t.jsx)(d.Z.Item,{name:"schedule_type",label:"\u5B9A\u65F6\u7C7B\u578B",initialValue:"crontab",rules:[{required:!0}],children:(0,t.jsxs)(z.ZP.Group,{onChange:Pe,children:[(0,t.jsx)(z.ZP,{value:"crontab",children:"crontab"}),(0,t.jsx)(z.ZP,{value:"interval",children:"interval"})]})}),(0,t.jsx)(d.Z.Item,{name:Y==="crontab"?"schedule":"interval_schedule",label:"\u5B9A\u65F6\u89C4\u5219",rules:[{required:!0},{validator:function(s,O){return Y==="interval"||!O||S().parseExpression(O).hasNext()?Promise.resolve():Promise.reject("Subscription\u8868\u8FBE\u5F0F\u683C\u5F0F\u6709\u8BEF")}}],children:Y==="interval"?(0,t.jsx)(Ae,{}):(0,t.jsx)(I.Z,{placeholder:"\u79D2(\u53EF\u9009) \u5206 \u65F6 \u5929 \u6708 \u5468"})}),B!=="file"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Z.Item,{name:"whitelist",label:"\u767D\u540D\u5355",tooltip:"\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272\uFF0C\u652F\u6301\u6B63\u5219\u8868\u8FBE\u5F0F",children:(0,t.jsx)(I.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u811A\u672C\u7B5B\u9009\u767D\u540D\u5355\u5173\u952E\u8BCD\uFF0C\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272"})}),(0,t.jsx)(d.Z.Item,{name:"blacklist",label:"\u9ED1\u540D\u5355",tooltip:"\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272\uFF0C\u652F\u6301\u6B63\u5219\u8868\u8FBE\u5F0F",children:(0,t.jsx)(I.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u811A\u672C\u7B5B\u9009\u9ED1\u540D\u5355\u5173\u952E\u8BCD\uFF0C\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272"})}),(0,t.jsx)(d.Z.Item,{name:"dependences",label:"\u4F9D\u8D56\u6587\u4EF6",tooltip:"\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272\uFF0C\u652F\u6301\u6B63\u5219\u8868\u8FBE\u5F0F",children:(0,t.jsx)(I.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u811A\u672C\u4F9D\u8D56\u6587\u4EF6\u5173\u952E\u8BCD\uFF0C\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272"})}),(0,t.jsx)(d.Z.Item,{name:"extensions",label:"\u6587\u4EF6\u540E\u7F00",tooltip:"\u4ED3\u5E93\u9700\u8981\u62C9\u53D6\u7684\u6587\u4EF6\u540E\u7F00\uFF0C\u591A\u4E2A\u540E\u7F00\u7A7A\u683C\u5206\u9694\uFF0C\u9ED8\u8BA4\u4F7F\u7528\u914D\u7F6E\u6587\u4EF6\u4E2D\u7684RepoFileExtensions",children:(0,t.jsx)(I.Z,{placeholder:"\u8BF7\u8F93\u5165\u6587\u4EF6\u540E\u7F00"})}),(0,t.jsx)(d.Z.Item,{name:"sub_before",label:"\u6267\u884C\u524D",tooltip:"\u8FD0\u884C\u8BA2\u9605\u524D\u6267\u884C\u7684\u547D\u4EE4\uFF0C\u6BD4\u5982 cp/mv/python3 xxx.py/node xxx.js",children:(0,t.jsx)(I.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u8FD0\u884C\u8BA2\u9605\u524D\u8981\u6267\u884C\u7684\u547D\u4EE4"})}),(0,t.jsx)(d.Z.Item,{name:"sub_after",label:"\u6267\u884C\u540E",tooltip:"\u8FD0\u884C\u8BA2\u9605\u540E\u6267\u884C\u7684\u547D\u4EE4\uFF0C\u6BD4\u5982 cp/mv/python3 xxx.py/node xxx.js",children:(0,t.jsx)(I.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u8FD0\u884C\u8BA2\u9605\u540E\u8981\u6267\u884C\u7684\u547D\u4EE4"})})]})]})})};C.default=ae},34541:function(p,C,e){"use strict";e.d(C,{Z:function(){return me}});var o=e(47220),l=e(96600),f=e(35931),m=e(60382),b=e(84875),r=e.n(b),c=e(1334),v=e(63313),h=e(71010),D=e(64065),he=e(84144),d=function(S,t){var P={};for(var i in S)Object.prototype.hasOwnProperty.call(S,i)&&t.indexOf(i)<0&&(P[i]=S[i]);if(S!=null&&typeof Object.getOwnPropertySymbols=="function")for(var y=0,i=Object.getOwnPropertySymbols(S);y<i.length;y++)t.indexOf(i[y])<0&&Object.prototype.propertyIsEnumerable.call(S,i[y])&&(P[i[y]]=S[i[y]]);return P},re=function(t){var P,i=t.prefixCls,y=t.className,ae=t.checked,q=t.onChange,L=t.onClick,Z=d(t,["prefixCls","className","checked","onChange","onClick"]),M=v.useContext(h.E_),V=M.getPrefixCls,H=function(ue){q==null||q(!ae),L==null||L(ue)},ee=V("tag",i),j=r()(ee,(P={},(0,o.Z)(P,"".concat(ee,"-checkable"),!0),(0,o.Z)(P,"".concat(ee,"-checkable-checked"),ae),P),y);return v.createElement("span",(0,l.Z)({},Z,{className:j,onClick:H}))},I=re,ne=function(S,t){var P={};for(var i in S)Object.prototype.hasOwnProperty.call(S,i)&&t.indexOf(i)<0&&(P[i]=S[i]);if(S!=null&&typeof Object.getOwnPropertySymbols=="function")for(var y=0,i=Object.getOwnPropertySymbols(S);y<i.length;y++)t.indexOf(i[y])<0&&Object.prototype.propertyIsEnumerable.call(S,i[y])&&(P[i[y]]=S[i[y]]);return P},J=new RegExp("^(".concat(D.Y.join("|"),")(-inverse)?$")),z=new RegExp("^(".concat(D.E.join("|"),")$")),de=function(t,P){var i,y=t.prefixCls,ae=t.className,q=t.style,L=t.children,Z=t.icon,M=t.color,V=t.onClose,H=t.closeIcon,ee=t.closable,j=ee===void 0?!1:ee,X=ne(t,["prefixCls","className","style","children","icon","color","onClose","closeIcon","closable"]),ue=v.useContext(h.E_),u=ue.getPrefixCls,w=ue.direction,Ee=v.useState(!0),Q=(0,f.Z)(Ee,2),B=Q[0],G=Q[1];v.useEffect(function(){"visible"in X&&G(X.visible)},[X.visible]);var le=function(){return M?J.test(M)||z.test(M):!1},pe=(0,l.Z)({backgroundColor:M&&!le()?M:void 0},q),Y=le(),g=u("tag",y),Fe=r()(g,(i={},(0,o.Z)(i,"".concat(g,"-").concat(M),Y),(0,o.Z)(i,"".concat(g,"-has-color"),M&&!Y),(0,o.Z)(i,"".concat(g,"-hidden"),!B),(0,o.Z)(i,"".concat(g,"-rtl"),w==="rtl"),i),ae),Oe=function(Ce){Ce.stopPropagation(),V==null||V(Ce),!Ce.defaultPrevented&&("visible"in X||G(!1))},De=function(){return j?H?v.createElement("span",{className:"".concat(g,"-close-icon"),onClick:Oe},H):v.createElement(m.Z,{className:"".concat(g,"-close-icon"),onClick:Oe}):null},oe="onClick"in X||L&&L.type==="a",je=(0,c.Z)(X,["visible"]),Se=Z||null,Pe=Se?v.createElement(v.Fragment,null,Se,v.createElement("span",null,L)):L,k=v.createElement("span",(0,l.Z)({},je,{ref:P,className:Fe,style:pe}),Pe,De());return oe?v.createElement(he.Z,null,k):k},ie=v.forwardRef(de);ie.CheckableTag=I;var me=ie},91394:function(){},13989:function(p,C,e){var o=e(33737);function l(f){if(Array.isArray(f))return o(f)}p.exports=l,p.exports.__esModule=!0,p.exports.default=p.exports},56037:function(p){function C(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}p.exports=C,p.exports.__esModule=!0,p.exports.default=p.exports},90623:function(p){function C(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}p.exports=C,p.exports.__esModule=!0,p.exports.default=p.exports},94434:function(p,C,e){var o=e(13989),l=e(56037),f=e(94945),m=e(90623);function b(r){return o(r)||l(r)||f(r)||m()}p.exports=b,p.exports.__esModule=!0,p.exports.default=p.exports}}]);
